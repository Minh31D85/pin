"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9275],{9275:(H,b,c)=>{c.r(b),c.d(b,{HomePageModule:()=>$});var k=c(2200),o=c(7343),h=c(4341),y=c(8132),m=c(467),e=c(3664);let C=(()=>{var l;class r{toggleEditName(){this.isEditName=!this.isEditName}toggleEditPin(){this.isEditPin=!this.isEditPin}constructor(i){this.modalCtrl=i,this.isEditName=!1,this.isEditPin=!1}editName(){this.isEditName=!0}editPin(){this.isEditPin=!0}cancel(){this.modalCtrl.dismiss(null,"cancel")}save(){const i=this.item.name.trim(),t=this.item.pin.trim();i?/^\d{4,8}$/.test(t)?this.modalCtrl.dismiss({index:this.index,updated:{name:i,pin:t}},"save"):alert("PIN must be numeric"):alert("name is required")}static#e=l=()=>(this.\u0275fac=function(t){return new(t||r)(e.rXU(o.W3))},this.\u0275cmp=e.VBU({type:r,selectors:[["app-modal"]],inputs:{index:"index",item:"item"},decls:22,vars:12,consts:[["slot","end"],[3,"click"],["position","stacked"],[1,"edit-btn",3,"ngModelChange","ngModel","readonly"],["slot","end","fill","clear",3,"click"],["slot","icon-only","size","large",3,"color","name"],["inputmode","numeric",1,"edit-btn",3,"ngModelChange","ngModel","readonly"],["expand","block","color","primary",1,"ion-margin-top",3,"click"]],template:function(t,n){1&t&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Bearbeiten"),e.k0s(),e.j41(4,"ion-buttons",0)(5,"ion-button",1),e.bIt("click",function(){return n.cancel()}),e.EFF(6,"Close"),e.k0s()()()(),e.j41(7,"ion-content")(8,"ion-item")(9,"ion-label",2),e.EFF(10,"name"),e.k0s(),e.j41(11,"ion-input",3),e.mxI("ngModelChange",function(a){return e.DH7(n.item.name,a)||(n.item.name=a),a}),e.k0s(),e.j41(12,"ion-button",4),e.bIt("click",function(){return n.toggleEditName()}),e.nrm(13,"ion-icon",5),e.k0s()(),e.j41(14,"ion-item")(15,"ion-label",2),e.EFF(16,"PIN"),e.k0s(),e.j41(17,"ion-input",6),e.mxI("ngModelChange",function(a){return e.DH7(n.item.pin,a)||(n.item.pin=a),a}),e.k0s(),e.j41(18,"ion-button",4),e.bIt("click",function(){return n.toggleEditPin()}),e.nrm(19,"ion-icon",5),e.k0s()(),e.j41(20,"ion-button",7),e.bIt("click",function(){return n.save()}),e.EFF(21," Speichern "),e.k0s()()),2&t&&(e.R7$(8),e.AVh("edit-active",n.isEditName),e.R7$(3),e.R50("ngModel",n.item.name),e.Y8G("readonly",!n.isEditName),e.R7$(2),e.Y8G("color",n.isEditName?"danger":"primary")("name",n.isEditName?"close-circle-outline":"add-circle-outline"),e.R7$(),e.AVh("edit-active",n.isEditPin),e.R7$(3),e.R50("ngModel",n.item.pin),e.Y8G("readonly",!n.isEditPin),e.R7$(2),e.Y8G("color",n.isEditPin?"danger":"primary")("name",n.isEditPin?"close-circle-outline":"add-circle-outline"))},dependencies:[o.bv,o.Jm,o.QW,o.W9,o.eU,o.iq,o.$w,o.uz,o.he,o.BC,o.ai,o.Gw,h.YN,h.BC,h.vS],styles:["ion-item.edit-active[_ngcontent-%COMP%]{--background: #f2f2f2;border-radius:8px}ion-item.edit-active[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:var(--ion-color-primary)}"]}))}return l(),r})();const g_backupApi_baseUrl="http://backup.home:8080/api",g_backupApi_apiKey="6>K?56KmfGw8f",g_backupApi_appName="pin",g_backupApi_schemaVersion=1;var u=c(2615),M=c(4166),E=c(6991),v=c(9330),I=c(9350),j=c(7707);function f(l,r){const d="object"==typeof r;return new Promise((i,t)=>{const n=new j.Ms({next:s=>{i(s),n.unsubscribe()},error:t,complete:()=>{d?i(r.defaultValue):t(new I.G)}});l.subscribe(n)})}let F=(()=>{var l;class r{constructor(i){this.http=i,this.baseUrl=g_backupApi_baseUrl,this.apiKey=g_backupApi_apiKey}headers(){return new v.Lr({Accept:"application/json","Content-Type":"application/json","X-API-KEY":this.apiKey})}url(i){return`${this.baseUrl}${i}`}list(i){var t=this;return(0,m.A)(function*(){return(yield f(t.http.get(t.url(`/backups/${encodeURIComponent(i)}/list`),{headers:t.headers()}))).files??[]})()}export(i,t){var n=this;return(0,m.A)(function*(){return yield f(n.http.post(n.url(`/backups/${encodeURIComponent(i)}/export`),t,{headers:n.headers()}))})()}latest(i){var t=this;return(0,m.A)(function*(){return yield f(t.http.get(t.url(`/backups/${encodeURIComponent(i)}/latest`),{headers:t.headers()}))})()}import(i,t){var n=this;return(0,m.A)(function*(){return yield f(n.http.post(n.url(`/backups/${encodeURIComponent(i)}/import`),{path:t},{headers:n.headers()}))})()}static#e=l=()=>(this.\u0275fac=function(t){return new(t||r)(u.KVO(v.Qq))},this.\u0275prov=u.jDH({token:r,factory:r.\u0275fac,providedIn:"root"}))}return l(),r})();function N(l,r){if(1&l){const d=e.RV6();e.j41(0,"ion-list")(1,"ion-item",13),e.bIt("click",function(){u.eBV(d);const t=e.XpG();return u.Njj(t.exportJSON())}),e.nrm(2,"ion-icon",14),e.EFF(3," Export "),e.k0s(),e.j41(4,"ion-item",13),e.bIt("click",function(){u.eBV(d);const t=e.XpG();return u.Njj(t.importJSON())}),e.nrm(5,"ion-icon",15),e.EFF(6," Import "),e.k0s()()}}function A(l,r){if(1&l){const d=e.RV6();e.j41(0,"ion-item",16),e.bIt("click",function(){const t=u.eBV(d).$implicit,n=e.XpG();return u.Njj(n.navigateTo(t))}),e.j41(1,"ion-label")(2,"h2"),e.EFF(3),e.k0s()(),e.j41(4,"ion-button",17),e.bIt("click",function(t){const n=u.eBV(d).index,s=e.XpG();return t.stopPropagation(),u.Njj(s.edit(n))}),e.nrm(5,"ion-icon",18),e.k0s(),e.j41(6,"ion-button",19),e.bIt("click",function(t){const n=u.eBV(d).index,s=e.XpG();return t.stopPropagation(),u.Njj(s.delete(n))}),e.nrm(7,"ion-icon",20),e.k0s()()}if(2&l){const d=r.$implicit;e.R7$(3),e.JRh(d.name)}}const T=[{path:"",component:(()=>{var l;class r{constructor(i,t,n,s,a){this.service=i,this.router=t,this.modalCtrl=n,this.alertCtrl=s,this.backupApi=a,this.name="",this.pin="",this.isPVisible=!1}ngOnInit(){var i=this;return(0,m.A)(function*(){yield i.service.load()})()}togglePVisible(){this.isPVisible=!this.isPVisible}generate(){var i=this;return(0,m.A)(function*(){const t=i.name.trim(),n=i.pin.trim();if(t)if(n)if(/^\d{4,8}$/.test(n))try{yield i.service.add({name:t,pin:n}),i.name="",i.pin="",i.isPVisible=!1}catch(s){if("NAME_EXISTS"===s.message)return alert(`${t} already exists`),void(i.name="");alert("unexpected error occurred")}else alert("PIN must be exactly 4 digits to 8 digits");else alert("PIN is required");else alert("name is required")})()}delete(i){var t=this;return(0,m.A)(function*(){yield(yield t.alertCtrl.create({header:"L\xf6schen",message:"Wollen Sie den PIN l\xf6schen?",buttons:[{text:"L\xf6schen",role:"destructive",handler:()=>{t.service.remove(i)}},{text:"Zur\xfcck",role:"cancel"}]})).present()})()}edit(i){var t=this;return(0,m.A)(function*(){const n=t.service.itemList[i];if(!n)return;const s=yield t.modalCtrl.create({component:C,componentProps:{index:i,item:{...n}},breakpoints:[0,.5,.9],initialBreakpoint:.5});yield s.present();const{data:a,role:p}=yield s.onWillDismiss();if("save"===p&&a?.updated)try{yield t.service.update(a.index,a.updated)}catch(_){"NAME_EXISTS"===_.message?alert(`${a.updated.name} already exists`):alert("unexpected error occurred")}})()}navigateTo(i){this.router.navigate(["/pin-detail",i.name])}exportJSON(){var i=this;return(0,m.A)(function*(){try{const t=g_backupApi_appName,s={schemaVersion:g_backupApi_schemaVersion,payload:{items:i.service.itemList},meta:{device:"android",appVersion:"1.0"}};yield i.backupApi.export(t,s),yield(yield i.alertCtrl.create({header:"Gespeichert",buttons:[{text:"Ok",role:"cancel"}]})).present()}catch(t){alert(`Export fehlgeschlagen: ${t?.message??"unbekannter Fehler"}`)}})()}importJSON(){var i=this;return(0,m.A)(function*(){try{const t=g_backupApi_appName,n=yield i.backupApi.latest(t),a=n.backup?.payload?.items;if(!Array.isArray(a))return void alert("Backup ist ung\xfcltig: payload fehlt oder kein Array");i.service.itemList=a,yield i.service.save(),yield(yield i.alertCtrl.create({header:`Import erfolgreich :\n${n.path}`,buttons:[{text:"Ok",role:"cancel"}]})).present()}catch(t){alert(`Import fehlgeschlagen: ${t?.message??"unbekannter Fehler"}`)}})()}listImport(){var i=this;return(0,m.A)(function*(){try{const t=g_backupApi_appName,n=yield i.backupApi.list(t);if(!n.length)return void alert("Kein Backup gefunden");yield(yield i.alertCtrl.create({header:"Backup ausw\xe4hlen",inputs:n.slice(0,10).map((a,p)=>({type:"radio",label:a,value:a,checked:0===p})),buttons:[{text:"Importieren",handler:(a=(0,m.A)(function*(p){const P=(yield i.backupApi.import(t,p)).payload?.items;Array.isArray(P)?(i.service.itemList=P,yield i.service.save(),yield(yield i.alertCtrl.create({header:`Import erfolgreich ${p}`,buttons:[{text:"ok",role:"cancel"}]})).present()):alert("Backup ist ung\xfcltig")}),function(_){return a.apply(this,arguments)})},{text:"Abbrechen",role:"cancel"}]})).present()}catch(t){alert(`Import fehlgeschlagen: ${t?.message??"unbekannter Fehler"}`)}var a})()}static#e=l=()=>(this.\u0275fac=function(t){return new(t||r)(e.rXU(M.k),e.rXU(E.Ix),e.rXU(o.W3),e.rXU(o.hG),e.rXU(F))},this.\u0275cmp=e.VBU({type:r,selectors:[["app-home"]],standalone:!1,decls:28,vars:7,consts:[[3,"translucent"],["slot","end"],["id","home-menu-trigger"],["slot","icon-only","name","menu-outline"],["trigger","home-menu-trigger","side","bottom","alignment","end","dismissOnSelect","true"],[3,"fullscreen"],["position","floating"],["type","text",3,"ngModelChange","keydown.enter","ngModel"],["inputmode","numeric",3,"ngModelChange","keydown.enter","type","ngModel"],["fill","clear","slot","end","type","button",3,"click"],["size","large","slot","icon-only",3,"name"],["expand","full","color","primary",3,"click"],[3,"click",4,"ngFor","ngForOf"],["button","",3,"click"],["name","cloud-upload-outline","slot","start"],["name","cloud-download-outline","slot","start"],[3,"click"],["slot","end","color","success",3,"click"],["slot","icon-only","name","create-outline"],["slot","end","color","danger",3,"click"],["slot","icon-only","name","trash-outline"]],template:function(t,n){1&t&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3," PIN "),e.k0s(),e.j41(4,"ion-buttons",1)(5,"ion-button",2),e.nrm(6,"ion-icon",3),e.k0s()()()(),e.j41(7,"ion-popover",4),e.DNE(8,N,7,0,"ng-template"),e.k0s(),e.j41(9,"ion-content",5)(10,"ion-card")(11,"ion-card-content")(12,"ion-item")(13,"ion-label",6),e.EFF(14,"Name"),e.k0s(),e.j41(15,"ion-input",7),e.mxI("ngModelChange",function(a){return e.DH7(n.name,a)||(n.name=a),a}),e.bIt("keydown.enter",function(){return n.generate()}),e.k0s()(),e.j41(16,"ion-item")(17,"ion-label",6),e.EFF(18,"Pin"),e.k0s(),e.j41(19,"ion-input",8),e.mxI("ngModelChange",function(a){return e.DH7(n.pin,a)||(n.pin=a),a}),e.bIt("keydown.enter",function(){return n.generate()}),e.j41(20,"ion-button",9),e.bIt("click",function(){return n.togglePVisible()}),e.nrm(21,"ion-icon",10),e.k0s()()(),e.j41(22,"ion-button",11),e.bIt("click",function(){return n.generate()}),e.EFF(23," hinzuf\xfcgen "),e.k0s()()(),e.j41(24,"ion-card")(25,"ion-card-content")(26,"ion-list"),e.DNE(27,A,8,1,"ion-item",12),e.k0s()()()()),2&t&&(e.Y8G("translucent",!0),e.R7$(9),e.Y8G("fullscreen",!0),e.R7$(6),e.R50("ngModel",n.name),e.R7$(4),e.Y8G("type",n.isPVisible?"text":"password"),e.R50("ngModel",n.pin),e.R7$(2),e.Y8G("name",n.isPVisible?"eye-off-outline":"eye-outline"),e.R7$(6),e.Y8G("ngForOf",n.service.itemList))},dependencies:[k.Sq,h.BC,h.vS,o.Jm,o.QW,o.b_,o.I9,o.W9,o.eU,o.iq,o.$w,o.uz,o.he,o.nf,o.BC,o.ai,o.CF,o.Gw],styles:["#container[_ngcontent-%COMP%]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:20px;line-height:26px}#container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}"]}))}return l(),r})()}];let V=(()=>{var l;class r{static#e=l=()=>(this.\u0275fac=function(t){return new(t||r)},this.\u0275mod=e.$C({type:r}),this.\u0275inj=u.G2t({imports:[y.iI.forChild(T),y.iI]}))}return l(),r})(),$=(()=>{var l;class r{static#e=l=()=>(this.\u0275fac=function(t){return new(t||r)},this.\u0275mod=e.$C({type:r}),this.\u0275inj=u.G2t({imports:[k.MD,h.YN,o.bv,V]}))}return l(),r})()}}]);