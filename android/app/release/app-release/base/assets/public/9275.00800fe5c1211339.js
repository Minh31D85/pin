"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9275],{9275:(R,b,d)=>{d.r(b),d.d(b,{HomePageModule:()=>G});var k=d(2200),r=d(7343),h=d(4341),v=d(8132),u=d(467),e=d(3664),l=d(2615);const C=["nameInput"],E=["pinInput"];let I=(()=>{var c;class s{constructor(t){this.modalCtrl=t,this.isEditName=!1,this.isEditPin=!1}setSheet(t){return(0,u.A)(function*(){const n=document.querySelector("ion-modal.edit-sheet");n?.setCurrentBreakpoint&&(yield n.setCurrentBreakpoint(t))})()}toggleEditName(){var t=this;return(0,u.A)(function*(){const n=!t.isEditName;n&&(t.isEditPin=!1,yield t.blurPin()),t.isEditName=n,t.isEditName?(yield t.setSheet(.9),requestAnimationFrame(()=>t.nameInput?.setFocus())):(yield t.blurName(),t.isEditPin||(yield t.setSheet(.5)))})()}toggleEditPin(){var t=this;return(0,u.A)(function*(){const n=!t.isEditPin;n&&(t.isEditName=!1,yield t.blurName()),t.isEditPin=n,t.isEditPin?(yield t.setSheet(.9),requestAnimationFrame(()=>t.pinInput?.setFocus())):(yield t.blurPin(),t.isEditName||(yield t.setSheet(.5)))})()}blurName(){var t=this;return(0,u.A)(function*(){(yield t.nameInput?.getInputElement())?.blur()})()}blurPin(){var t=this;return(0,u.A)(function*(){(yield t.pinInput?.getInputElement())?.blur()})()}editName(){this.isEditName=!0}editPin(){this.isEditPin=!0}cancel(){this.modalCtrl.dismiss(null,"cancel")}save(){const t=this.item.name.trim(),n=this.item.pin.trim();t?/^\d{4,8}$/.test(n)?this.modalCtrl.dismiss({index:this.index,updated:{name:t,pin:n}},"save"):alert("PIN must be numeric"):alert("name is required")}static#e=c=()=>(this.\u0275fac=function(n){return new(n||s)(e.rXU(r.W3))},this.\u0275cmp=e.VBU({type:s,selectors:[["app-modal"]],viewQuery:function(n,i){if(1&n&&(e.GBs(C,5),e.GBs(E,5)),2&n){let o;e.mGM(o=e.lsd())&&(i.nameInput=o.first),e.mGM(o=e.lsd())&&(i.pinInput=o.first)}},inputs:{index:"index",item:"item"},decls:24,vars:13,consts:[["nameInput",""],["pinInput",""],["slot","end"],[3,"click"],[3,"scrollY"],["position","stacked"],[3,"ngModelChange","ngModel","readonly"],["slot","end","fill","clear",3,"click"],["slot","icon-only","size","large",3,"color","name"],["inputmode","numeric",3,"ngModelChange","ngModel","readonly"],["expand","block","color","primary",1,"ion-margin-top",3,"click"]],template:function(n,i){if(1&n){const o=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Bearbeiten"),e.k0s(),e.j41(4,"ion-buttons",2)(5,"ion-button",3),e.bIt("click",function(){return l.eBV(o),l.Njj(i.cancel())}),e.EFF(6,"Close"),e.k0s()()()(),e.j41(7,"ion-content",4)(8,"ion-item")(9,"ion-label",5),e.EFF(10,"name"),e.k0s(),e.j41(11,"ion-input",6,0),e.mxI("ngModelChange",function(m){return l.eBV(o),e.DH7(i.item.name,m)||(i.item.name=m),l.Njj(m)}),e.k0s(),e.j41(13,"ion-button",7),e.bIt("click",function(){return l.eBV(o),l.Njj(i.toggleEditName())}),e.nrm(14,"ion-icon",8),e.k0s()(),e.j41(15,"ion-item")(16,"ion-label",5),e.EFF(17,"PIN"),e.k0s(),e.j41(18,"ion-input",9,1),e.mxI("ngModelChange",function(m){return l.eBV(o),e.DH7(i.item.pin,m)||(i.item.pin=m),l.Njj(m)}),e.k0s(),e.j41(20,"ion-button",7),e.bIt("click",function(){return l.eBV(o),l.Njj(i.toggleEditPin())}),e.nrm(21,"ion-icon",8),e.k0s()(),e.j41(22,"ion-button",10),e.bIt("click",function(){return l.eBV(o),l.Njj(i.save())}),e.EFF(23," Speichern "),e.k0s()()}2&n&&(e.R7$(7),e.Y8G("scrollY",!0),e.R7$(),e.AVh("edit-active",i.isEditName),e.R7$(3),e.R50("ngModel",i.item.name),e.Y8G("readonly",!i.isEditName),e.R7$(3),e.Y8G("color",i.isEditName?"danger":"primary")("name",i.isEditName?"close-circle-outline":"add-circle-outline"),e.R7$(),e.AVh("edit-active",i.isEditPin),e.R7$(3),e.R50("ngModel",i.item.pin),e.Y8G("readonly",!i.isEditPin),e.R7$(3),e.Y8G("color",i.isEditPin?"danger":"primary")("name",i.isEditPin?"close-circle-outline":"add-circle-outline"))},dependencies:[r.bv,r.Jm,r.QW,r.W9,r.eU,r.iq,r.$w,r.uz,r.he,r.BC,r.ai,r.Gw,h.YN,h.BC,h.vS],styles:["ion-item.edit-active[_ngcontent-%COMP%]{--background: #f2f2f2;border-radius:8px}ion-item.edit-active[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:var(--ion-color-primary)}ion-content[_ngcontent-%COMP%]{--keyboard-offset: 0px}"]}))}return c(),s})();const g_backupApi_baseUrl="http://192.168.178.101/api",g_backupApi_apiKey="6>K?56KmfGw8f",g_backupApi_appName="pin",g_backupApi_schemaVersion=1;var j=d(4166),N=d(6991),_=d(9330),M=d(9350),A=d(7707);function f(c,s){const p="object"==typeof s;return new Promise((t,n)=>{const i=new A.Ms({next:o=>{t(o),i.unsubscribe()},error:n,complete:()=>{p?t(s.defaultValue):n(new M.G)}});c.subscribe(i)})}let F=(()=>{var c;class s{constructor(t){this.http=t,this.baseUrl=g_backupApi_baseUrl,this.apiKey=g_backupApi_apiKey}headers(){return new _.Lr({Accept:"application/json","Content-Type":"application/json","X-API-KEY":this.apiKey})}url(t){return`${this.baseUrl.replace(/\/+$/,"")}${t.startsWith("/")?t:`/${t}`}`}list(t){var n=this;return(0,u.A)(function*(){return(yield f(n.http.get(n.url(`/backups/${encodeURIComponent(t)}/list`),{headers:n.headers()}))).files??[]})()}export(t,n){var i=this;return(0,u.A)(function*(){return yield f(i.http.post(i.url(`/backups/${encodeURIComponent(t)}/export`),n,{headers:i.headers()}))})()}latest(t){var n=this;return(0,u.A)(function*(){return yield f(n.http.get(n.url(`/backups/${encodeURIComponent(t)}/latest`),{headers:n.headers()}))})()}import(t,n){var i=this;return(0,u.A)(function*(){return yield f(i.http.post(i.url(`/backups/${encodeURIComponent(t)}/import`),{path:n},{headers:i.headers()}))})()}health(){var t=this;return(0,u.A)(function*(){return yield f(t.http.get(t.url("/_health"),{headers:new _.Lr({Accept:"application/json"})}))})()}static#e=c=()=>(this.\u0275fac=function(n){return new(n||s)(l.KVO(_.Qq))},this.\u0275prov=l.jDH({token:s,factory:s.\u0275fac,providedIn:"root"}))}return c(),s})();function V(c,s){if(1&c){const p=e.RV6();e.j41(0,"ion-list")(1,"ion-item",13),e.bIt("click",function(){l.eBV(p);const n=e.XpG();return l.Njj(n.exportJSON())}),e.nrm(2,"ion-icon",14),e.EFF(3," Export "),e.k0s(),e.j41(4,"ion-item",13),e.bIt("click",function(){l.eBV(p);const n=e.XpG();return l.Njj(n.importJSON())}),e.nrm(5,"ion-icon",15),e.EFF(6," Import "),e.k0s()()}}function B(c,s){if(1&c){const p=e.RV6();e.j41(0,"ion-item",16),e.bIt("click",function(){const n=l.eBV(p).$implicit,i=e.XpG();return l.Njj(i.navigateTo(n))}),e.j41(1,"ion-label")(2,"h2"),e.EFF(3),e.k0s()(),e.j41(4,"ion-button",17),e.bIt("click",function(n){const i=l.eBV(p).index,o=e.XpG();return n.stopPropagation(),l.Njj(o.edit(i))}),e.nrm(5,"ion-icon",18),e.k0s(),e.j41(6,"ion-button",19),e.bIt("click",function(n){const i=l.eBV(p).index,o=e.XpG();return n.stopPropagation(),l.Njj(o.delete(i))}),e.nrm(7,"ion-icon",20),e.k0s()()}if(2&c){const p=s.$implicit;e.R7$(3),e.JRh(p.name)}}const $=[{path:"",component:(()=>{var c;class s{constructor(t,n,i,o,a){this.service=t,this.router=n,this.modalCtrl=i,this.alertCtrl=o,this.backupApi=a,this.name="",this.pin="",this.isPVisible=!1}ngOnInit(){var t=this;return(0,u.A)(function*(){yield t.service.load()})()}togglePVisible(){this.isPVisible=!this.isPVisible}generate(){var t=this;return(0,u.A)(function*(){const n=t.name.trim(),i=t.pin.trim();if(n)if(i)if(/^\d{4,8}$/.test(i))try{yield t.service.add({name:n,pin:i}),t.name="",t.pin="",t.isPVisible=!1}catch(o){if("NAME_EXISTS"===o.message)return alert(`${n} already exists`),void(t.name="");alert("unexpected error occurred")}else alert("PIN must be exactly 4 digits to 8 digits");else alert("PIN is required");else alert("name is required")})()}delete(t){var n=this;return(0,u.A)(function*(){yield(yield n.alertCtrl.create({header:"L\xf6schen",message:"Wollen Sie den PIN l\xf6schen?",buttons:[{text:"L\xf6schen",role:"destructive",handler:()=>{n.service.remove(t)}},{text:"Zur\xfcck",role:"cancel"}]})).present()})()}edit(t){var n=this;return(0,u.A)(function*(){const i=n.service.itemList[t];if(!i)return;const o=yield n.modalCtrl.create({component:I,componentProps:{index:t,item:{...i}},cssClass:"edit-sheet",breakpoints:[0,.5,.9],initialBreakpoint:.5});yield o.present();const{data:a,role:m}=yield o.onWillDismiss();if("save"===m&&a?.updated)try{yield n.service.update(a.index,a.updated)}catch(y){"NAME_EXISTS"===y.message?alert(`${a.updated.name} already exists`):alert("unexpected error occurred")}})()}navigateTo(t){this.router.navigate(["/pin-detail",t.name])}exportJSON(){var t=this;return(0,u.A)(function*(){try{const n=g_backupApi_appName,o={schemaVersion:g_backupApi_schemaVersion,payload:{items:t.service.itemList},meta:{device:"android",appVersion:"1.0"}};yield t.backupApi.export(n,o),yield(yield t.alertCtrl.create({header:"Gespeichert",buttons:[{text:"Ok",role:"cancel"}]})).present()}catch(n){alert(`Export fehlgeschlagen: ${n?.message??"unbekannter Fehler"}`)}})()}importJSON(){var t=this;return(0,u.A)(function*(){try{const n=g_backupApi_appName,i=yield t.backupApi.latest(n),a=i.backup?.payload?.items;if(!Array.isArray(a))return void alert("Backup ist ung\xfcltig: payload fehlt oder kein Array");t.service.itemList=a,yield t.service.save(),yield(yield t.alertCtrl.create({header:`Import erfolgreich :\n${i.path}`,buttons:[{text:"Ok",role:"cancel"}]})).present()}catch(n){alert(`Import fehlgeschlagen: ${n?.message??"unbekannter Fehler"}`)}})()}listImport(){var t=this;return(0,u.A)(function*(){try{const n=g_backupApi_appName,i=yield t.backupApi.list(n);if(!i.length)return void alert("Kein Backup gefunden");yield(yield t.alertCtrl.create({header:"Backup ausw\xe4hlen",inputs:i.slice(0,10).map((a,m)=>({type:"radio",label:a,value:a,checked:0===m})),buttons:[{text:"Importieren",handler:(a=(0,u.A)(function*(m){const P=(yield t.backupApi.import(n,m)).payload?.items;Array.isArray(P)?(t.service.itemList=P,yield t.service.save(),yield(yield t.alertCtrl.create({header:`Import erfolgreich ${m}`,buttons:[{text:"ok",role:"cancel"}]})).present()):alert("Backup ist ung\xfcltig")}),function(y){return a.apply(this,arguments)})},{text:"Abbrechen",role:"cancel"}]})).present()}catch(n){alert(`Import fehlgeschlagen: ${n?.message??"unbekannter Fehler"}`)}var a})()}health(){var t=this;return(0,u.A)(function*(){try{const n=yield t.backupApi.health();yield(yield t.alertCtrl.create({header:n.ok?"Health OK":"Health FEHLER",message:`<pre>${JSON.stringify(n,null,2)}</pre>`,buttons:[{text:"OK",role:"cancel"}]})).present()}catch(n){const i=n?.error?"string"==typeof n.error?n.error:JSON.stringify(n.error,null,2):n?.message??"unbekannter Fehler";yield(yield t.alertCtrl.create({header:"Health FEHLER",message:`<pre>${i}</pre>`,buttons:[{text:"OK",role:"cancel"}]})).present()}})()}static#e=c=()=>(this.\u0275fac=function(n){return new(n||s)(e.rXU(j.k),e.rXU(N.Ix),e.rXU(r.W3),e.rXU(r.hG),e.rXU(F))},this.\u0275cmp=e.VBU({type:s,selectors:[["app-home"]],standalone:!1,decls:28,vars:7,consts:[[3,"translucent"],["slot","end"],["id","home-menu-trigger"],["slot","icon-only","name","menu-outline"],["trigger","home-menu-trigger","side","bottom","alignment","end","dismissOnSelect","true"],[3,"fullscreen"],["position","floating"],["type","text",3,"ngModelChange","keydown.enter","ngModel"],["inputmode","numeric",3,"ngModelChange","keydown.enter","type","ngModel"],["fill","clear","slot","end","type","button",3,"click"],["size","large","slot","icon-only",3,"name"],["expand","full","color","primary",3,"click"],[3,"click",4,"ngFor","ngForOf"],["button","",3,"click"],["name","cloud-upload-outline","slot","start"],["name","cloud-download-outline","slot","start"],[3,"click"],["slot","end","color","success",3,"click"],["slot","icon-only","name","create-outline"],["slot","end","color","danger",3,"click"],["slot","icon-only","name","trash-outline"]],template:function(n,i){1&n&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3," PIN "),e.k0s(),e.j41(4,"ion-buttons",1)(5,"ion-button",2),e.nrm(6,"ion-icon",3),e.k0s()()()(),e.j41(7,"ion-popover",4),e.DNE(8,V,7,0,"ng-template"),e.k0s(),e.j41(9,"ion-content",5)(10,"ion-card")(11,"ion-card-content")(12,"ion-item")(13,"ion-label",6),e.EFF(14,"Name"),e.k0s(),e.j41(15,"ion-input",7),e.mxI("ngModelChange",function(a){return e.DH7(i.name,a)||(i.name=a),a}),e.bIt("keydown.enter",function(){return i.generate()}),e.k0s()(),e.j41(16,"ion-item")(17,"ion-label",6),e.EFF(18,"Pin"),e.k0s(),e.j41(19,"ion-input",8),e.mxI("ngModelChange",function(a){return e.DH7(i.pin,a)||(i.pin=a),a}),e.bIt("keydown.enter",function(){return i.generate()}),e.j41(20,"ion-button",9),e.bIt("click",function(){return i.togglePVisible()}),e.nrm(21,"ion-icon",10),e.k0s()()(),e.j41(22,"ion-button",11),e.bIt("click",function(){return i.generate()}),e.EFF(23," hinzuf\xfcgen "),e.k0s()()(),e.j41(24,"ion-card")(25,"ion-card-content")(26,"ion-list"),e.DNE(27,B,8,1,"ion-item",12),e.k0s()()()()),2&n&&(e.Y8G("translucent",!0),e.R7$(9),e.Y8G("fullscreen",!0),e.R7$(6),e.R50("ngModel",i.name),e.R7$(4),e.Y8G("type",i.isPVisible?"text":"password"),e.R50("ngModel",i.pin),e.R7$(2),e.Y8G("name",i.isPVisible?"eye-off-outline":"eye-outline"),e.R7$(6),e.Y8G("ngForOf",i.service.itemList))},dependencies:[k.Sq,h.BC,h.vS,r.Jm,r.QW,r.b_,r.I9,r.W9,r.eU,r.iq,r.$w,r.uz,r.he,r.nf,r.BC,r.ai,r.CF,r.Gw],styles:["#container[_ngcontent-%COMP%]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:20px;line-height:26px}#container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}"]}))}return c(),s})()}];let H=(()=>{var c;class s{static#e=c=()=>(this.\u0275fac=function(n){return new(n||s)},this.\u0275mod=e.$C({type:s}),this.\u0275inj=l.G2t({imports:[v.iI.forChild($),v.iI]}))}return c(),s})(),G=(()=>{var c;class s{static#e=c=()=>(this.\u0275fac=function(n){return new(n||s)},this.\u0275mod=e.$C({type:s}),this.\u0275inj=l.G2t({imports:[k.MD,h.YN,r.bv,H]}))}return c(),s})()}}]);